create or replace view  VW_COBERTURA_ENTES AS (SELECT 
(SELECT NOMBRE_ente FROM tb_ente WHERE nit_ente =ente.NIT_ENTE 
    ) nombre_ente ,
    (SELECT NOMBRE FROM TB_DEPARTAMENTO WHERE CODIGO =PERFIL.CODIGO_DEPTO 
    ) DEPARTAMENTO ,
    (SELECT NOMBRE FROM TB_MUNICIPIO WHERE CODIGO =PERFIL.CODIGO_MUNICIPIO 
    ) MUNICIPIO ,
    (SELECT NOMBRE FROM VW_DIAS WHERE CODIGO =PERFIL.DIA_INICIO
    )
    || ' a '
    ||
    (SELECT NOMBRE FROM VW_DIAS WHERE CODIGO =PERFIL.DIA_FIN
    )
    || ' de '
    || TO_CHAR(PERFIL.HORA_INICIO,'hh24:MM')
    ||' a '
    ||TO_CHAR(PERFIL.HORA_FIN,'hh24:MM')
    || ' Horas' HORARIO
  FROM VW_DATOS_PERFIL_ENTE ENTE,
    TB_PERFIL_COBERTURA PERFIL
  WHERE ENTE.CODIGO_PERFIL = PERFIL.CODIGO_PERFIL);